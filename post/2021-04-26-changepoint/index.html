<!DOCTYPE html>
<html lang="en-us">
    <head>
        

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Change Point Detection</title>
        
        <style>

    html body {
        font-family: 'Raleway', sans-serif;
        background-color: white;
    }

    :root {
        --accent: #4682B4;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://christian43.github.io/css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" crossorigin="anonymous">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />
 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/R.min.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script>






<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.96.0" />
        

        

        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        

    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">Change Point Detection</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Start</a></li>
                            
                                <li><a href="/about/">About</a></li>
                            
                                <li><a href="/post/">Posts</a></li>
                            
                                <li><a href="/project/">Projects</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:saalchris@googlemail.com"><i class="fas fa-envelope"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/christian43"><i class="fab fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://twitter.com/@saalcs/"><i class="fab fa-twitter"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.linkedin.com/in/christian-saal-27211077/"><i class="fab fa-linkedin"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.stackoverflow.com/users/7425115/christian/"><i class="fab fa-stack-overflow"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<main>

    <div>
        <h2>Change Point Detection</h2>
        <h5>April 26, 2021</h5>
        
<a href="https://christian43.github.io/tags/r"><kbd class="item-tag">R</kbd></a>


    </div>

    <div align="start" class="content"><h4 id="könnte-interessant-sein">Könnte interessant sein..</h4>
<p>In diesem Beitrag zeige ich ganz kurz und knapp wie Segmente innerhalb einer Verlaufskurve detektiert
werden können. Verlaufskurven kommen im Sport ja recht häufig vor. Am Beispiel meiner Laufdaten, die
von einer Smart Watch aufgezeichnet wurden, zeige ich eine mögliche Vorgehensweise mit R.</p>
<p>Eine schöne Übersicht über die verschiedenen Vorgehensweisen bietet <a href="https://www.marinedatascience.co/blog/2019/09/28/comparison-of-change-point-detection-methods/">Saskia
Otto</a>
auf ihrer Homepage. Etwas ausführlicher beschäftigen sich <a href="https://arxiv.org/pdf/2003.06222.pdf">Burg &amp; Williams
(2020)</a> mit den verschiedenen Ansätzen.</p>
<p>Der Datensatz ist vorab schon bearbeitet und bereinigt.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># load package</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(changepoint)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># inspect data</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span>(myrun)
</span></span></code></pre></div><pre tabindex="0"><code>&#39;data.frame&#39;:	2215 obs. of  10 variables:
 $ activity_id: chr  &#34;bae93b27-755d-440d-b964-4f83bd42faff&#34; &#34;bae93b27-755d-440d-b964-4f83bd42faff&#34; &#34;bae93b27-755d-440d-b964-4f83bd42faff&#34; &#34;bae93b27-755d-440d-b964-4f83bd42faff&#34; ...
 $ altitude   : num  37.8 37.8 37.8 37.8 37.8 37.8 37.8 37.8 37.8 37.8 ...
 $ cadence    : logi  NA NA NA NA NA NA ...
 $ distance   : num  4.1 11.1 23.6 37 50.6 ...
 $ heartrate  : int  69 75 82 91 96 110 126 130 131 134 ...
 $ speed      : num  0.4 1.1 2 2.6 2.7 2.7 2.7 2.8 2.8 2.7 ...
 $ time       : int  15 20 25 30 35 40 45 50 55 60 ...
 $ idS        : int  35 35 35 35 35 35 35 35 35 35 ...
 $ index      : int  1 2 3 4 5 6 7 8 9 10 ...
 $ pace       : num  41.7 15.2 8.3 6.4 6.2 6.2 6.2 6 6 6.2 ...
</code></pre><p>Mich interessiert vor allem die Laufgeschwindigkeit, die als Variable Speed vorliegt.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># plot it </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span>(myrun<span style="color:#f92672">$</span>speed, type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;l&#34;</span>,
</span></span><span style="display:flex;"><span>	 xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Index&#34;</span>,
</span></span><span style="display:flex;"><span>	 ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Speed [m/s]&#34;</span>,
</span></span><span style="display:flex;"><span>	 main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;My evening run&#34;</span>)
</span></span></code></pre></div><p><img src="figure/unnamed-chunk-3-1.png" alt="plot of chunk unnamed-chunk-3"></p>
<p>Auf den ersten Blick eigentlich recht konstant. Normalerweise laufe ich zur Erwärmung ein paar
Minuten langsamer, um dann am Parkeingang eine kleine Pause für Dehnungsübungen zu machen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># detect change points</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cpt <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cpt.mean</span>(myrun<span style="color:#f92672">$</span>speed,
</span></span><span style="display:flex;"><span>				method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PELT&#34;</span>,
</span></span><span style="display:flex;"><span>				penalty <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BIC&#34;</span>,
</span></span><span style="display:flex;"><span>				class <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span>cpt
</span></span></code></pre></div><pre tabindex="0"><code>[1]   56  146 2043 2156 2215
</code></pre><p>Die Ausgabe zeigt die Punkte auf der X-Achse, die nun auch visualisiert werden können.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># plot it again and mark the points</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span>(myrun<span style="color:#f92672">$</span>speed, type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;l&#34;</span>,
</span></span><span style="display:flex;"><span>	 xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Index&#34;</span>,
</span></span><span style="display:flex;"><span>	 ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Speed [m/s]&#34;</span>,
</span></span><span style="display:flex;"><span>	 main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;My evening run&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">abline</span>(v <span style="color:#f92672">=</span> cpt, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;red&#34;</span>) 
</span></span></code></pre></div><p><img src="figure/unnamed-chunk-5-1.png" alt="plot of chunk unnamed-chunk-5"></p>
<p>Was für einen Lauf geht, geht natürlich auch für ein Set von Läufen. So können Segmente gefiltert
werden und beispielsweise die Erwärmung oder andere definierte Abschnitte genauer analysiert werden.</p>
</div>

    
    
    
        <h4 class="page-header">Related</h4>
         <div class="item">

    
    
    

    
    

    <h4><a href="/post/2021-12-20-xmas/">Xmas Tree in R</a></h4>
    <h5>December 21, 2021</h5>
    
<a href="https://christian43.github.io/tags/r"><kbd class="item-tag">R</kbd></a>



</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/2021-11-23-apple/">Explore Apple Health Data</a></h4>
    <h5>November 28, 2021</h5>
    
<a href="https://christian43.github.io/tags/r"><kbd class="item-tag">R</kbd></a>



</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/2021-10-29-vim/vim-slime/">Using R and Vim together</a></h4>
    <h5>October 29, 2021</h5>
    
<a href="https://christian43.github.io/tags/vim"><kbd class="item-tag">Vim</kbd></a>

<a href="https://christian43.github.io/tags/r"><kbd class="item-tag">R</kbd></a>



</div>
 
    

    
    
        <h4 class="page-header">Comments</h4>
        <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "username" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

</main>

        <footer>
            <p class="copyright text-muted"><a href="/impressum">Impressum</a> | <a href="/datenschutz">Datenschutz</a> | © All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a>.</p> </footer> 

        
    </body>

</html>


